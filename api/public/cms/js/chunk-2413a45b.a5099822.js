(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2413a45b"],{"53c8":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"adddiscount"},[s("el-container",[s("el-aside",{attrs:{width:"200px"}},[s("NavTo")],1),s("el-container",[s("el-header",{staticStyle:{"border-bottom":"1px solid #d0d0d0","background-color":"#FFFFFF"}},[s("Header")],1),s("transition",{attrs:{appear:"","appear-active-class":"animated fadeInLeft"}},[s("el-main",[s("div",{staticClass:"add"},[s("div",{staticClass:"add_btn"},[s("el-button",{attrs:{type:"primary"},on:{click:t.jumpback}},[t._v("返回")])],1),s("div",{staticClass:"xiao"},[t._v("活动信息")]),s("el-form",{ref:"form",staticClass:"demo-dynamic",attrs:{model:t.form,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"活动名称"}},[s("el-input",{staticStyle:{width:"500px"},attrs:{"hide-required-asterisk":""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),s("el-form-item",{attrs:{label:"生效时间"}},[s("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.form.start_time,callback:function(e){t.$set(t.form,"start_time",e)},expression:"form.start_time"}}),t._v("\n\t\t\t\t\t\t\t\t 至 \n\t\t\t\t\t\t\t\t"),s("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.form.end_time,callback:function(e){t.$set(t.form,"end_time",e)},expression:"form.end_time"}})],1),s("el-row",[s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"参团人数"}},[s("el-input",{staticStyle:{width:"300px"},attrs:{"hide-required-asterisk":""},model:{value:t.form.user_num,callback:function(e){t.$set(t.form,"user_num",e)},expression:"form.user_num"}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"提前显示时间"}},[s("el-input",{staticStyle:{width:"60%"},attrs:{"hide-required-asterisk":""},model:{value:t.form.visible_time,callback:function(e){t.$set(t.form,"visible_time",e)},expression:"form.visible_time"}}),t._v("小时\n\t\t\t\t\t\t\t\t\t")],1)],1)],1),s("el-row",[s("el-col",{attrs:{span:4}},[s("el-form-item",{attrs:{label:"参团有效时间"}},[s("el-input",{staticStyle:{width:"60%"},attrs:{"hide-required-asterisk":""},model:{value:t.form.pt_time,callback:function(e){t.$set(t.form,"pt_time",e)},expression:"form.pt_time"}}),t._v("\n\t\t\t\t\t\t\t\t\t\t小时\n\t\t\t\t\t\t\t\t\t")],1)],1),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{placeholder:"请选择签收方式"},model:{value:t.form.is_sign_one,callback:function(e){t.$set(t.form,"is_sign_one",e)},expression:"form.is_sign_one"}},t._l(t.options,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),s("el-col",{attrs:{span:2}},[s("el-checkbox",{attrs:{"true-label":1,"false-label":0,label:"仅好友拼团",border:""},on:{change:t.is_friend},model:{value:t.form.is_cou_tuan,callback:function(e){t.$set(t.form,"is_cou_tuan",e)},expression:"form.is_cou_tuan"}})],1),1!=t.is_show?s("el-col",{attrs:{span:2}},[s("el-checkbox",{attrs:{"true-label":1,"false-label":0,label:"仅限新人",border:""},model:{value:t.form.is_new_user,callback:function(e){t.$set(t.form,"is_new_user",e)},expression:"form.is_new_user"}})],1):t._e(),1==t.is_show?s("el-col",{attrs:{span:3}},[s("el-checkbox",{attrs:{"true-label":1,"false-label":0,label:"开启模拟成团",border:""},on:{change:t.is_cheng},model:{value:t.form.is_cheng_tuan,callback:function(e){t.$set(t.form,"is_cheng_tuan",e)},expression:"form.is_cheng_tuan"}})],1):t._e(),t.cheng?s("el-col",{attrs:{span:3}},[s("el-input",{attrs:{placeholder:"请输入模拟成团人数限制","hide-required-asterisk":""},model:{value:t.form.cheng_tuan_num,callback:function(e){t.$set(t.form,"cheng_tuan_num",e)},expression:"form.cheng_tuan_num"}})],1):t._e()],1),s("el-form-item",{attrs:{label:"限购设置",prop:"resource"}},[s("el-radio-group",{staticStyle:{"margin-top":"15px"},model:{value:t.form.is_buy_num,callback:function(e){t.$set(t.form,"is_buy_num",e)},expression:"form.is_buy_num"}},[s("el-radio",{attrs:{label:0}},[t._v("不限购")]),s("el-radio",{attrs:{label:1}},[t._v("每人每种商品限购 "),1==t.form.is_buy_num?s("el-input",{staticStyle:{width:"100px"},model:{value:t.form.buy_num,callback:function(e){t.$set(t.form,"buy_num",e)},expression:"form.buy_num"}}):t._e(),t._v(" 件")],1)],1)],1)],1),s("div",{staticClass:"xiao"},[t._v("选择活动商品")]),s("el-tabs",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"border-card"},model:{value:t.active_name,callback:function(e){t.active_name=e},expression:"active_name"}},[s("el-tab-pane",{attrs:{label:"第一步：选择商品",name:"one"}},[s("div",{staticClass:"choose"},[s("div",{staticClass:"search"},[s("el-select",{attrs:{placeholder:"所有分组"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[s("el-option",{attrs:{label:"一",value:"shanghai"}}),s("el-option",{attrs:{label:"二",value:"beijing"}})],1),t._v(" \n\t\t\t\t\t\t\t\t\t\t"),s("el-button",{attrs:{type:"primary"}},[t._v("搜索")])],1),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[s("el-table-column",{attrs:{prop:"",label:"商品信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"pro"},[s("div",{staticClass:"pro_02"},[s("img",{attrs:{src:t.getimg+e.row.imgs}})]),s("div",{staticClass:"pro_03"},[s("div",{staticClass:"pro_03_1"},[t._v(t._s(e.row.goods_name))]),s("div",{staticClass:"pro_03_2"},[t._v("¥"+t._s(e.row.price))])])])]}}])}),s("el-table-column",{attrs:{prop:"stock",label:"库存"}}),s("el-table-column",{attrs:{prop:"operation",label:"操作",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.is_discount?s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(s){return t.add_discout(e.row.goods_id,e.$index,e.row)}}},[t._v("参加拼团")]):t._e(),2==e.row.is_discount?s("el-button",{attrs:{slot:"reference",type:"danger",size:"small"},on:{click:function(s){return t.del(e.$index)}},slot:"reference"},[t._v("取消参加")]):t._e()]}}])})],1)],1),s("div",{staticClass:"quan"},[s("div",{staticClass:"quan_r"},[t._v("共5条，每页30条")])])]),1==t.is_two?s("el-tab-pane",{attrs:{label:"第二步：设置拼团",name:"two"}},[s("div",{staticClass:"choose"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.discount_list}},[s("el-table-column",{attrs:{prop:"",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"pro"},[s("div",{staticClass:"pro_02"},[s("img",{attrs:{src:t.getimg+e.row.imgs}})]),s("div",{staticClass:"pro_03"},[s("div",{staticClass:"pro_03_1"},[t._v(t._s(e.row.goods.goods_name))]),s("div",{staticClass:"pro_03_2"},[t._v("¥"+t._s(e.row.goods.price))])])])]}}],null,!1,3231941480)}),s("el-table-column",{attrs:{prop:"",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t减价："),s("el-input",{staticStyle:{width:"100px"},attrs:{"hide-required-asterisk":""},model:{value:e.row.price,callback:function(s){t.$set(e.row,"price",s)},expression:"scope.row.price"}})],1)]}}],null,!1,513019034)}),s("el-table-column",{attrs:{prop:"",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.price?[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t减价后："+t._s(e.row.goods.price-e.row.price)+"元\n\t\t\t\t\t\t\t\t\t\t\t")]:void 0}}],null,!0)}),s("el-table-column",{attrs:{prop:"operation",label:"",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(s){return t.del_disgoods(e.$index)}}},[t._v("取消")])]}}],null,!1,3443465662)})],1)],1),s("div",{staticClass:"quan"},[s("div",{staticClass:"quan_r"},[t._v("共5条，每页30条")])])]):t._e()],1),s("span",{staticClass:"dialog-footer ",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.jumpback}},[t._v("取 消")]),0==t.is_two?s("el-button",{on:{click:t.next}},[t._v("下一步")]):t._e(),1==t.is_two?s("el-button",{on:{click:t.back}},[t._v("上一步")]):t._e(),1==t.is_two?s("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确 定")]):t._e()],1)],1)])],1)],1)],1)],1)},o=[],a=(s("7cfd"),s("7893"),s("a49b"),s("15fc")),n=s("71c2"),l={data:function(){return{options:[{value:0,label:"团员自行签收"},{value:1,label:"团员可选是否团长代收"},{value:2,label:"团长代收"}],is_show:1,cheng:"",active_name:"two",is_two:1,discount_list:[],getimg:this.$getimg,choose:!0,tableData:[],tab_nav:!1,oid:0,form:{is_cheng_tuan:"",is_cou_tuan:"",is_sign_one:"",is_new_user:"",user_num:"",pt_time:"",buy_num:"",name:"",goods_json:[],is_buy_num:"",start_time:"",end_time:"",cheng_tuan_num:"",visible_time:""},list:[],all:"",size:10,total:0,value:""}},watch:{active_name:function(){"one"==this.active_name&&(this.is_two=0),"two"==this.active_name&&(this.is_two=1)}},components:{Header:n["a"],NavTo:a["a"]},mounted:function(){var t=JSON.parse(localStorage.getItem("edit_data"));t&&(console.log(t),this.form.id=t.id,this.form.name=t.name,this.form.start_time=t.start_time,this.form.end_time=t.end_time,this.form.buy_num=t.buy_num,this.form.is_buy_num=t.is_buy_num,this.form.is_cheng_tuan=t.is_cheng_tuan,this.form.is_cou_tuan=t.is_cou_tuan,this.form.is_sign_one=t.is_sign_one,this.form.pt_time=t.pt_time,this.form.visible_time=t.visible_time,this.form.user_num=t.user_num,this.discount_list=t.pt_goods,this.form.is_new_user=t.is_new_user,1==t.is_new_user&&(this.is_show=0),1==t.is_cheng_tuan?(this.cheng=!0,this.form.cheng_tuan_num=t.cheng_tuan_num):this.cheng=!1),this._load()},methods:{_load:function(){var t=this;this.http.get("product/admin/get_normal_goods").then((function(e){for(var s in e.data){var i=e.data[s];i.is_discount=1}t.tableData=e.data,console.log(t.tableData)}))},add_discout:function(t,e,s){var i={goods_id:t,price:""},o={goods_id:s.goods_id,goods:{goods_name:s.goods_name,price:s.price},price:""};this.tableData[e].is_discount=2,this.form.goods_json.push(i),this.discount_list.push(o),console.log(this.form),console.log(this.discount_list)},is_cheng:function(t){console.log(t),this.cheng=t,this.form.cheng_tuan_num="",this.form.is_cou_tuan=1==t?0:1},is_friend:function(t){1==t?(this.is_show=0,this.form.is_cheng_tuan=0,this.cheng=0):(this.is_show=1,this.form.is_new_user=0)},del:function(t){this.tableData[t].is_discount=1,this.form.goods_json.splice(t,1),this.discount_list.splice(t,1),console.log(this.form)},del_disgoods:function(t){this.discount_list.splice(t,1)},next:function(){this.active_name="two",this.is_two=1},back:function(){this.is_two=0,this.active_name="one"},onSubmit:function(){var t=this;console.log(this.discount_list);var e=this,s=[],i={goods_id:"",price:""};for(var o in this.discount_list){var a=this.discount_list[o];i.goods_id=a.goods_id,i.price=a.price,s.push(i),i={goods_id:"",price:""}}this.form.goods_json=s,console.log(this.form),this.http.post_show("pt/admin/edit_pt",this.form).then((function(s){400==s.status?e.$message({showClose:!0,message:s.msg,type:"warning"}):e.$message({showClose:!0,message:"修改成功",type:"success"}),t.jumpback()}))},jumpback:function(){this.$router.push({path:"./pt"})}}},r=l,c=(s("5553"),s("4e82")),u=Object(c["a"])(r,i,o,!1,null,null,null);e["default"]=u.exports},5553:function(t,e,s){"use strict";var i=s("9f9f"),o=s.n(i);o.a},"7cfd":function(t,e,s){var i=s("d3d8").f,o=Function.prototype,a=/^\s*function ([^ (]*)/,n="name";n in o||s("f9a5")&&i(o,n,{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},"9f9f":function(t,e,s){}}]);