(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-381da104"],{3566:function(t,e,o){},"3f66":function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"adddiscount"},[o("el-container",[o("el-aside",{attrs:{width:"200px"}},[o("NavTo")],1),o("el-container",[o("el-header",{staticStyle:{"border-bottom":"1px solid #d0d0d0","background-color":"#FFFFFF"}},[o("Header")],1),o("transition",{attrs:{appear:"","appear-active-class":"animated fadeInLeft"}},[o("el-main",[o("div",{staticClass:"add"},[o("div",{staticClass:"add_btn"},[o("el-button",{attrs:{type:"primary"},on:{click:t.jumpback}},[t._v("返回")])],1),o("div",{staticClass:"xiao"},[t._v("活动信息")]),o("el-form",{ref:"form",staticClass:"demo-dynamic",attrs:{model:t.form,"label-width":"120px"}},[o("el-form-item",{attrs:{label:"活动名称"}},[o("el-input",{staticStyle:{width:"500px"},attrs:{"hide-required-asterisk":""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"生效时间"}},[o("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.form.start_time,callback:function(e){t.$set(t.form,"start_time",e)},expression:"form.start_time"}}),t._v("\n\t\t\t\t\t\t\t\t 至 \n\t\t\t\t\t\t\t\t"),o("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.form.end_time,callback:function(e){t.$set(t.form,"end_time",e)},expression:"form.end_time"}})],1),o("el-form-item",{attrs:{label:"活动标签"}},[o("el-input",{staticStyle:{width:"300px"},attrs:{"hide-required-asterisk":""},model:{value:t.form.label,callback:function(e){t.$set(t.form,"label",e)},expression:"form.label"}})],1),o("el-form-item",{attrs:{label:"限购设置",prop:"resource"}},[o("el-radio-group",{model:{value:t.form.buy_rule,callback:function(e){t.$set(t.form,"buy_rule",e)},expression:"form.buy_rule"}},[o("el-radio",{attrs:{label:0}},[t._v("不限购")]),o("el-radio",{attrs:{label:1}},[t._v("每人每种商品限购 "),1==t.form.buy_rule?o("el-input",{staticStyle:{width:"100px"},model:{value:t.form.buy_num,callback:function(e){t.$set(t.form,"buy_num",e)},expression:"form.buy_num"}}):t._e(),t._v(" 件")],1),o("el-radio",{attrs:{label:2}},[t._v("每人每种商品前 "),2==t.form.buy_rule?o("el-input",{staticStyle:{width:"100px"},model:{value:t.form.buy_num,callback:function(e){t.$set(t.form,"buy_num",e)},expression:"form.buy_num"}}):t._e(),t._v(" 件享受折扣")],1)],1)],1)],1),o("div",{staticClass:"xiao"},[t._v("选择活动商品")]),o("el-tabs",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"border-card"},model:{value:t.active_name,callback:function(e){t.active_name=e},expression:"active_name"}},[o("el-tab-pane",{attrs:{label:"第一步：选择商品",name:"one"}},[o("div",{staticClass:"choose"},[o("div",{staticClass:"search"},[o("el-select",{attrs:{placeholder:"所有分组"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[o("el-option",{attrs:{label:"一",value:"shanghai"}}),o("el-option",{attrs:{label:"二",value:"beijing"}})],1),t._v(" \n\t\t\t\t\t\t\t\t\t\t"),o("el-button",{attrs:{type:"primary"}},[t._v("搜索")])],1),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"row-class-name":t.tableRowClassName}},[o("el-table-column",{attrs:{prop:"",label:"商品信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"pro"},[o("div",{staticClass:"pro_02"},[o("img",{attrs:{src:t.getimg+e.row.imgs}})]),o("div",{staticClass:"pro_03"},[o("div",{staticClass:"pro_03_1"},[t._v(t._s(e.row.goods_name))]),o("div",{staticClass:"pro_03_2"},[t._v("¥"+t._s(e.row.price))])])])]}}])}),o("el-table-column",{attrs:{prop:"stock",label:"库存"}}),o("el-table-column",{attrs:{prop:"operation",label:"操作",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.is_discount?o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(o){return t.add_discout(e.row.goods_id,e.$index,e.row)}}},[t._v("参加折扣")]):t._e(),2==e.row.is_discount?o("el-button",{attrs:{slot:"reference",type:"danger",size:"small"},on:{click:function(o){return t.del(e.$index)}},slot:"reference"},[t._v("取消参加")]):t._e()]}}])})],1)],1),o("div",{staticClass:"quan"},[o("div",{staticClass:"quan_r"},[t._v("共5条，每页30条")])])]),1==t.is_two?o("el-tab-pane",{attrs:{label:"第二步：设置折扣",name:"two"}},[o("div",{staticClass:"choose"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.discount_list,"row-class-name":t.tableRowClassName}},[o("el-table-column",{attrs:{prop:"",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"pro"},[o("div",{staticClass:"pro_02"},[o("img",{attrs:{src:t.getimg+e.row.imgs}})]),o("div",{staticClass:"pro_03"},[o("div",{staticClass:"pro_03_1"},[t._v(t._s(e.row.goods.goods_name))]),o("div",{staticClass:"pro_03_2"},[t._v("¥"+t._s(e.row.goods.price))])])])]}}],null,!1,3231941480)}),o("el-table-column",{attrs:{prop:"",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t减价："),o("el-input",{staticStyle:{width:"100px"},attrs:{"hide-required-asterisk":""},model:{value:e.row.reduce_price,callback:function(o){t.$set(e.row,"reduce_price",o)},expression:"scope.row.reduce_price"}})],1)]}}],null,!1,2920657925)}),o("el-table-column",{attrs:{prop:"",label:""},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.reduce_price?[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t减价后："+t._s(e.row.goods.price-e.row.reduce_price)+"元\n\t\t\t\t\t\t\t\t\t\t\t")]:void 0}}],null,!0)}),o("el-table-column",{attrs:{prop:"operation",label:"",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(o){return t.del_disgoods(e.$index)}}},[t._v("取消")])]}}],null,!1,3443465662)})],1)],1),o("div",{staticClass:"quan"},[o("div",{staticClass:"quan_r"},[t._v("共5条，每页30条")])])]):t._e(),o("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":t.jump_page}})],1),o("span",{staticClass:"dialog-footer ",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.jumpback}},[t._v("取 消")]),0==t.is_two?o("el-button",{on:{click:t.next}},[t._v("下一步")]):t._e(),1==t.is_two?o("el-button",{on:{click:t.back}},[t._v("上一步")]):t._e(),1==t.is_two?o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确 定")]):t._e()],1)],1)])],1)],1)],1)],1)},i=[],a=(o("7cfd"),o("7893"),o("a49b"),o("15fc")),l=o("71c2"),n={data:function(){return{active_name:"two",is_two:1,discount_list:[],getimg:this.$getimg,choose:!0,tableData:[],tab_nav:!1,dialogVisibleadd:!1,dialogFormVisible:!1,oid:0,form:{id:"",name:"",buy_rule:"",goods_json:[],label:"",start_time:"",end_time:"",day_json:[],time_rule:0,buy_num:""},list:[],all:"",size:10,total:"",value:""}},watch:{active_name:function(){"one"==this.active_name&&(this.is_two=0),"two"==this.active_name&&(this.is_two=1)}},components:{Header:l["a"],NavTo:a["a"]},mounted:function(){var t=JSON.parse(localStorage.getItem("edit_data"));t&&(console.log(t),this.form.id=t.id,this.form.name=t.name,this.form.start_time=t.start_time,this.form.end_time=t.end_time,this.form.label=t.label,this.discount_list=t.discount_goods,this.form.buy_rule=t.buy_rule,this.form.buy_num=t.buy_num),this._load()},methods:{_load:function(){var t=this;this.http.get("product/admin/get_normal_goods").then((function(e){for(var o in e.data){var s=e.data[o];s.is_discount=1}t.all=e.data,t.total=e.data.length,t.tableData=e.data.slice(0,t.size),console.log(t.tableData)}))},jump_page:function(t){console.log(t);var e=this,o=(t-1)*e.size,s=t*e.size;console.log(o,s),this.tableData=this.all.slice(o,s)},add_discout:function(t,e,o){var s={goods_id:t,discount_type:1,reduce_price:"",discount_price:0},i={imgs:o.imgs,goods_id:o.goods_id,goods:{goods_name:o.goods_name,price:o.price},reduce_price:"",discount_type:1,discount_price:0};this.tableData[e].is_discount=2,this.form.goods_json.push(s),this.discount_list.push(i),console.log(this.form),console.log(this.discount_list)},del:function(t){this.tableData[t].is_discount=1,this.form.goods_json.splice(t,1),this.discount_list.splice(t,1),console.log(this.form)},del_disgoods:function(t){this.discount_list.splice(t,1)},get_goods:function(t){console.log(t)},next:function(){this.active_name="two",this.is_two=1},back:function(){this.is_two=0,this.active_name="one"},onSubmit:function(){var t=this;console.log(this.discount_list);var e=this,o=[],s={goods_id:"",discount_type:"",reduce_price:"",discount_price:""};for(var i in this.discount_list){var a=this.discount_list[i];s.goods_id=a.goods_id,s.discount_type=a.discount_type,s.reduce_price=a.reduce_price,s.discount_price=a.discount_price,o.push(s),s={goods_id:"",discount_type:"",reduce_price:"",discount_price:""}}this.form.goods_json=o,console.log(this.form),this.http.post_show("discount/admin/edit_discount",this.form).then((function(o){400==o.status?e.$message({showClose:!0,message:o.msg,type:"success"}):e.$message({showClose:!0,message:"修改成功",type:"success"}),t.jumpback()}))},add_user:function(){this.dialogVisibleadd=!0},edit:function(t,e,o,s,i,a){this.form.id=t,this.form.goods_name=e,this.form.content=o,this.form.img_id=s,this.form.stock=i,this.form.points=a,console.log(this.form)},jumpback:function(){this.$router.push({path:"./discount"})},goods_json:function(){}}},r=n,c=(o("ff47"),o("4e82")),d=Object(c["a"])(r,s,i,!1,null,null,null);e["default"]=d.exports},"7cfd":function(t,e,o){var s=o("d3d8").f,i=Function.prototype,a=/^\s*function ([^ (]*)/,l="name";l in i||o("f9a5")&&s(i,l,{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},ff47:function(t,e,o){"use strict";var s=o("3566"),i=o.n(s);i.a}}]);